<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>JSON-RPC 2.0</title>
</head>
<body>
    <h1>JSON-RPC 2.0</h1>

    <div id="result"></div>

    <script type="text/javascript" src="jrpc.js"></script>
    <script>
        window.onload = function () {

            testHello();

            // testFindCities();

        }

        function testHello() {
            var person = {
                "firstname": "World",
                "address": { "place": "Universe" },
                "phones": [
                    { "type": "work", "number": "331-11111111" },
                    { "type": "pers", "number": "349-22222222" }
                ],
                "emails": ["test@email.com", "dev@emai.com"]
            };

            jrpc.execute('TEST.hello', [person],
                function (result) {
                    document.getElementById("result").innerHTML = '<p>Result: <strong>' + result + '</strong></p>';
                },
                function (error) {
                    document.getElementById("result").innerHTML = '<p>Error: <strong>' + error.message + '</strong></p>';
                }
            );
        }

        function testFindCities() {
            var filter = { "countryCode": "ITA" };

            jrpc.execute('DBMS.findCities', [filter],
                function (result) {
                    document.getElementById("result").innerHTML = '<p>Result:<br> ' + arrayToHtml(result) + '</p>';
                },
                function (error) {
                    document.getElementById("result").innerHTML = '<p>Error: <strong>' + error.message + '</strong></p>';
                }
            );
        }

        function arrayToHtml(array) {
            if (!array) return "";

            var result = "";
            for (var i = 0; i < array.length; i++) {
                result += "<strong>[" + array[i]["id"] + "] " + array[i]["name"] + "</strong><br>";
            }

            return result;
        }
    </script>
</body>
</html>